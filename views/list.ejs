<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/main.css" rel="stylesheet">
    <title>Document</title>
</head>
<body class="grey-bg">

    <!-- include(íŒŒì¼ìœ„ì¹˜)ë¥¼ í†µí•´, jsë¥¼ ë¶™ì¼ ìˆ˜ ìˆìŒ -->
    <%- include('nav.ejs') %>

    <div class="white-bg">

    <!-- ë°˜ë³µë¬¸ì„ í†µí•´ jsë³€ìˆ˜ ë‚´ë¶€ ê°ì²´ë°°ì—´ì˜ ê°’ì„ ë°˜ë³µí•´ì„œ ë§Œë“¤ì–´ ë‚¸ HTML íƒœê·¸ -->
    <% for (var i = 0; i < ê¸€ëª©ë¡.length; i++){ %>

        <div class="white-box">
            <div class="list-box">
                <!-- í…œí”Œë¦¿ ê¸°í˜¸ëŠ” ""ì•ˆì—ì„œë„ ì¸ì‹ë˜ë©°, ë§í¬ë¥¼ ë§Œë“¤ìˆ˜ ìˆê²Œ í•¨ -->
                <a href="/detail/<%= ê¸€ëª©ë¡[i]._id %>">
                    <h4><%= ê¸€ëª©ë¡[i].title %></h4>
                </a>
                <p><%= ê¸€ëª©ë¡[i].content %></p>
                <!-- ìˆ˜ì •í™”ë©´ ì´ë™ ë²„íŠ¼ -->
                <a href="/edit/<%= ê¸€ëª©ë¡[i]._id %>">âœï¸</a>
                <!-- ì‚­ì œê¸°ëŠ¥ ìˆ˜í–‰ ë²„íŠ¼ -->
                <span class="delete1">ğŸ—‘ï¸</span>
                <span class="delete2" data-id="<%= ê¸€ëª©ë¡[i]._id %>" data-row="<%= i %>">ğŸ—‘ï¸</span>
            </div>
        </div>
        
    <% } %> 

    </div> 
    <div style="text-align: center"> 
        <!-- <%= JSON.stringify(ê¸€ëª©ë¡) %> -->
        <%= ë‚ ì§œ %>
    </div> 
</body>
<script>

    <% for (var i = 0; i < ê¸€ëª©ë¡.length; i++){ %>

            // ì‚­ì œê¸°ëŠ¥ êµ¬í˜„1) FORMíƒœê·¸ ì—†ì´ ì´ë²¤íŠ¸ë¦¬ìŠ¤ë„ˆë¥¼ í†µí•œ í´ë¦­ì‹œ ê²Œì‹œë¬¼ ì´ë²¤íŠ¸ êµ¬í˜„
            document.querySelectorAll('.delete1')[<%= i %>].addEventListener('click', function(){
                if( confirm('1ë²ˆì§¸ ë°©ì‹ìœ¼ë¡œ ì‚­ì œí• ê¹Œìš”?') ){
                    fetch(`/delete?id=<%= ê¸€ëª©ë¡[i]._id %>`,  { method : 'DELETE' })
                }
            });

            // ì‚­ì œê¸°ëŠ¥ êµ¬í˜„2) êµ¬í˜„1ì— HTMLì˜ data ì†ì„±ì„ ì´ìš©í•˜ì—¬ ë§Œë“¤ì–´ì§„ dataset ê°ì²´ë¥¼ í†µí•´ ê°’ì„ ê°€ì ¸ì™€ êµ¬í˜„
            document.querySelectorAll('.delete2')[<%= i %>].addEventListener('click', function(e){
                if( confirm('2ë²ˆì§¸ ë°©ì‹ìœ¼ë¡œ ì‚­ì œí• ê¹Œìš”?') ){
                    fetch('/delete?id=' + e.target.dataset.id, { method : 'DELETE' })
                }
            });
    <% } %> 

    document.querySelectorAll('.delete')[0].addEventListener('click', function(e){
        fetch('/delete?docid=' + e.target.dataset.id, { method : 'DELETE' })
    }) 

</script>
</html>